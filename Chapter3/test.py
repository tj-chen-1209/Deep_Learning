import torch 


y = torch.tensor([0, 1, 2, 3])
y_hat = torch.tensor([[0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0],
                        [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0],
                        [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0],
                        [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]])
# 计算交叉熵损失
loss = y_hat[range(len(y_hat)), y]
loss_ = y_hat.gather(1, y.view(-1, 1))
print("Loss:", loss.view(-1, 1) == loss_)  # 将loss转换为列向量形式